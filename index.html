<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0b1220">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <title>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏±‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô (100 ‡∏•‡∏∞ 20 / 24 ‡∏ß‡∏±‡∏ô)</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="wrap">
    <h1>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ‚Äú‡∏ï‡∏±‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‚Äù (100 ‡∏•‡∏∞ 20 / 24 ‡∏ß‡∏±‡∏ô)</h1>
    <p class="sub">
      ‡∏™‡∏π‡∏ï‡∏£: ‡∏á‡∏ß‡∏î/‡∏ß‡∏±‡∏ô = ‡∏¢‡∏≠‡∏î√∑20, ‡∏£‡∏±‡∏ö‡∏à‡∏£‡∏¥‡∏á = 90%, ‡∏¢‡∏≠‡∏î‡∏Ñ‡πâ‡∏≤‡∏á = (24-‡∏ß‡∏±‡∏ô‡∏™‡πà‡∏á)√ó‡∏á‡∏ß‡∏î‡πÄ‡∏î‡∏¥‡∏°/‡∏ß‡∏±‡∏ô
      <br>‡∏ï‡∏±‡∏î‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤: ‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏±‡∏î = ‡∏£‡∏±‡∏ö‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏î‡∏¥‡∏° ‚àí ‡∏¢‡∏≠‡∏î‡∏Ñ‡πâ‡∏≤‡∏á | ‡∏•‡∏î‡∏¢‡∏≠‡∏î/‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≠‡∏î: ‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏î‡πâ = ‡∏£‡∏±‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏¢‡∏≠‡∏î‡πÉ‡∏´‡∏°‡πà ‚àí ‡∏¢‡∏≠‡∏î‡∏Ñ‡πâ‡∏≤‡∏á
    </p>

    <!-- NAV BAR (2 ‡∏´‡∏ô‡πâ‡∏≤) -->
    <div class="nav">
      <button id="nav_calc" class="navBtn active" type="button">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
      <button id="nav_history" class="navBtn" type="button">
        ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ <span id="historyCount" class="badge">0</span>
      </button>
    </div>

    <!-- PAGE: CALCULATOR -->
    <section id="page_calc">
      <div class="toolbar">
        <label class="toolField">
          <div class="lbl">‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</div>
          <input id="customerName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏°‡∏ä‡∏≤‡∏¢ / ‡∏£‡πâ‡∏≤‡∏ô A" />
        </label>

        <div class="toolButtons">
          <button id="copyBtn" class="btn copy" type="button">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</button>
          <button id="themeToggle" class="btn" type="button" aria-label="‡∏™‡∏•‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏µ">üåô</button>
          <div id="copyStatus" class="status" aria-live="polite"></div>
        </div>
      </div>

      <div class="row">
        <button id="m_normal" class="btn active" type="button">‡∏ï‡∏±‡∏î‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤</button>
        <button id="m_reduce" class="btn" type="button">‡∏ï‡∏±‡∏î‡∏•‡∏î‡∏¢‡∏≠‡∏î</button>
        <button id="m_increase" class="btn" type="button">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≠‡∏î</button>
      </div>

      <div class="card">
        <h3 class="cardTitle">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°</h3>
        <div class="grid">
          <label>
            <div class="lbl">‡∏¢‡∏≠‡∏î‡πÄ‡∏î‡∏¥‡∏° (‡∏ö‡∏≤‡∏ó)</div>
            <input id="oldPrincipal" value="100000" inputmode="numeric" />
          </label>

          <label>
            <div class="lbl">‡∏™‡πà‡∏á‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß (‡∏ß‡∏±‡∏ô) 0‚Äì24</div>
            <input id="daysPaid" value="10" inputmode="numeric" />
          </label>

          <div>
            <div class="lbl">‡∏á‡∏ß‡∏î‡πÄ‡∏î‡∏¥‡∏°/‡∏ß‡∏±‡∏ô</div>
            <div class="read" id="payPerDayOld">-</div>
          </div>

          <div>
            <div class="lbl">‡∏£‡∏±‡∏ö‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏î‡∏¥‡∏° (90%)</div>
            <div class="read" id="receiveOld">-</div>
          </div>

          <div>
            <div class="lbl">‡∏ß‡∏±‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á</div>
            <div class="read" id="daysOwed">-</div>
          </div>

          <div>
            <div class="lbl">‡∏¢‡∏≠‡∏î‡∏Ñ‡πâ‡∏≤‡∏á</div>
            <div class="read" id="owedAmount">-</div>
          </div>
        </div>
      </div>

      <div id="newBox" class="card mt12 hidden">
        <h3 class="cardTitle" id="newTitle">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏≠‡∏î‡πÉ‡∏´‡∏°‡πà</h3>
        <div class="grid">
          <label>
            <div class="lbl">‡∏¢‡∏≠‡∏î‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ (‡∏ö‡∏≤‡∏ó)</div>
            <input id="newPrincipal" value="80000" inputmode="numeric" />
          </label>

          <div>
            <div class="lbl">‡∏£‡∏±‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏¢‡∏≠‡∏î‡πÉ‡∏´‡∏°‡πà (90%)</div>
            <div class="read" id="receiveNew">-</div>
          </div>

          <div>
            <div class="lbl">‡∏á‡∏ß‡∏î‡πÉ‡∏´‡∏°‡πà/‡∏ß‡∏±‡∏ô</div>
            <div class="read" id="payPerDayNew">-</div>
          </div>

          <div>
            <div class="lbl">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏¢‡∏≠‡∏î‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà ‚Äú‡∏ï‡∏±‡∏î‡πÑ‡∏î‡πâ‚Äù</div>
            <div class="read" id="minNewPrincipal">-</div>
          </div>
        </div>
      </div>

      <div class="card mt12">
        <h3 class="cardTitle">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</h3>

        <div id="normalResult">
          <div class="resultLine">
            ‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ = ‡∏£‡∏±‡∏ö‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏î‡∏¥‡∏° ‚àí ‡∏¢‡∏≠‡∏î‡∏Ñ‡πâ‡∏≤‡∏á = <b id="cashOutNormal">-</b>
          </div>
          <div class="hint">
            ‡∏ñ‡πâ‡∏≤‡∏ï‡∏¥‡∏î‡∏•‡∏ö ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤ ‚Äú‡∏¢‡∏±‡∏á‡∏ï‡∏±‡∏î‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‚Äù (‡∏¢‡∏≠‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏±‡∏ö‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏î‡∏¥‡∏°)
          </div>
        </div>

        <div id="newResult" class="hidden">
          <div class="resultLine">‡∏ï‡∏±‡∏î‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°: <span id="canCut">-</span></div>
          <div class="resultLine">
            ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö = ‡∏£‡∏±‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏¢‡∏≠‡∏î‡πÉ‡∏´‡∏°‡πà ‚àí ‡∏¢‡∏≠‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏° = <b id="cashOutNew">-</b>
          </div>
          <div class="hint">
            ‡∏ñ‡πâ‡∏≤‡∏ï‡∏¥‡∏î‡∏•‡∏ö = ‡∏ï‡∏±‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° ‚Äú‡∏¢‡∏≠‡∏î‡πÉ‡∏´‡∏°‡πà‚Äù ‡πÉ‡∏´‡πâ‡∏ñ‡∏∂‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡πà‡∏á‡∏ß‡∏±‡∏ô‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏¢‡∏≠‡∏î‡∏Ñ‡πâ‡∏≤‡∏á)
          </div>
        </div>

        <div class="topnote">
          ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏´‡∏•‡∏±‡∏á ‚Äú‡∏ï‡∏±‡∏î‚Äù ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡πÉ‡∏´‡∏°‡πà <b>1/24 ‡∏ß‡∏±‡∏ô</b> ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
        </div>
      </div>
    </section>

    <!-- PAGE: HISTORY -->
    <section id="page_history" class="hidden">
      <div class="card">
        <div class="historyHeader">
          <h3 class="cardTitle" style="margin:0;">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</h3>
          <div style="display:flex; gap:10px; flex-wrap:wrap;">
            <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏≤‡πÉ‡∏™‡πà JS ‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏±‡∏î‡πÑ‡∏õ -->
            <button id="exportXlsxAllBtn" class="btn" type="button">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å Excel (‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)</button>
            <button id="clearHistoryBtn" class="btn danger" type="button">‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
          </div>
        </div>

        <div class="hint" style="margin-top:8px;">
          ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå <b>.xlsx</b> (‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô Excel ‡πÑ‡∏î‡πâ) ‚Äî ‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÉ‡∏™‡πà JS ‡∏´‡∏ô‡πâ‡∏≤ export
        </div>

        <div id="historyList" class="historyList" style="margin-top:12px;"></div>
      </div>
    </section>
  </div>

  <!-- ‚úÖ SheetJS (XLSX) -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <!-- app -->
  <script src="./app.js"></script>
</body>
</html>

